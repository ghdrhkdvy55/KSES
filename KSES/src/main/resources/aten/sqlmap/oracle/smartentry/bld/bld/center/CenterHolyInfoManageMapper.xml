<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kses.backoffice.bld.center.mapper.CenterHolyInfoManageMapper">
	<select id="selectCenterHolyInfoList" resultType="lmap">
		SELECT 
			A.CENTER_HOLY_SEQ,
			A.CENTER_CD,
			A.HOLY_DT,
			A.HOLY_NM,
			A.USE_YN,
			TO_CHAR(A.LAST_UPDT_DTM, 'yyyy-mm-dd') AS LAST_UPDT_DTM,
			A.LAST_UPDUSR_ID,  
			B.CENTER_NM
		FROM TSEB_CENTERHOLY_INFO_I A, TSEB_CENTER_INFO_M B
		WHERE A.CENTER_CD = #{centerCd}
		AND A.CENTER_CD = B.CENTER_CD  
	</select>
	
	<insert id="insertCenterHolyInfo">
		INSERT INTO TSEB_CENTERHOLY_INFO_I 
		(
			CENTER_HOLY_SEQ, CENTER_CD, HOLY_DT, HOLY_NM, USE_YN, 
			FRST_REGTER_ID, FRST_REGIST_DTM, LAST_UPDUSR_ID, LAST_UPDT_DTM
		)
		VALUES 	
		(
			SEQ_ESB_CENTERHOLY_INFO.NEXTVAL, #{centerCd}, #{holyDt, jdbcType=VARCHAR}, #{holyNm, jdbcType=VARCHAR}, #{useYn, jdbcType=VARCHAR}, 
			#{frstRegterId, jdbcType=VARCHAR}, SYSDATE, #{lastUpdusrId, jdbcType=VARCHAR}, SYSDATE
		)
	</insert>
     
	<update id="updateCenterHolyInfo">	
		UPDATE TSEB_CENTERHOLY_INFO_I SET 
			HOLY_DT = #{holyDt, jdbcType=VARCHAR},
			HOLY_NM = #{holyNm, jdbcType=VARCHAR},
			USE_YN = #{useYn, jdbcType=VARCHAR},
			LAST_UPDUSR_ID = #{lastUpdusrId, jdbcType=VARCHAR},
			LAST_UPDT_DTM = SYSDATE				
		WHERE CENTER_HOLY_SEQ = #{centerHolySeq}
	</update>
	
	<update id="copyCenterHolyInfo">
		UPDATE TSEB_NOSHOW_INFO_M A
		SET (A.NOSHOW_AM_TM, A.NOSHOW_PM_TM, A.NOSHOW_ALL_TM, A.LAST_UPDT_DTM, A.LAST_UPDUSR_ID) = 
	   	(
	   		SELECT B.NOSHOW_AM_TM, B.NOSHOW_PM_TM, B.NOSHOW_ALL_TM, SYSDATE, 'COPY_TEST'
			FROM TSEB_NOSHOW_INFO_M B 
			WHERE A.NOSHOW_DAY = B.NOSHOW_DAY 
			AND B.CENTER_CD = #{params.copyCenterCd}
		)
		WHERE A.CENTER_CD = #{params.targetCenterCd}
	</update>
</mapper>